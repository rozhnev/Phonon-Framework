{"version":3,"file":"phonon-spa.js","sources":["../../src/js/common/events/dispatch.js","../../src/js/hybrid-apps/pager/page.js","../../src/js/common/events/index.js","../../src/js/hybrid-apps/pager/index.js","../../src/js/hybrid-apps/i18n/binder.js","../../src/js/hybrid-apps/i18n/index.js","../../src/js/phonon-spa.js"],"sourcesContent":["export function dispatchWinDocEvent(eventName, moduleName, detail = {}) {\n  const fullEventName = `${eventName}.ph.${moduleName}`;\n  window.dispatchEvent(new CustomEvent(fullEventName, { detail }));\n  document.dispatchEvent(new CustomEvent(fullEventName, { detail }));\n}\n\nexport function dispatchElementEvent(domElement, eventName, moduleName, detail = {}) {\n  const fullEventName = `${eventName}.ph.${moduleName}`;\n  domElement.dispatchEvent(new CustomEvent(fullEventName, { detail }));\n}\n\nexport function dispatchPageEvent(eventName, pageName, detail = {}) {\n  const fullEventName = `${pageName}.${eventName}`;\n  window.dispatchEvent(new CustomEvent(fullEventName, { detail }));\n  document.dispatchEvent(new CustomEvent(fullEventName, { detail }));\n}\n","/**\n * --------------------------------------------------------------------------\n * Licensed under MIT (https://github.com/quark-dev/Phonon-Framework/blob/master/LICENSE)\n * --------------------------------------------------------------------------\n */\n\nimport { dispatchPageEvent } from '../../common/events/dispatch';\n\nconst Page = (() => {\n  /**\n   * ------------------------------------------------------------------------\n   * Constants\n   * ------------------------------------------------------------------------\n   */\n\n  const NAME = 'page';\n  const VERSION = '2.0.0';\n\n  const TEMPLATE_SELECTOR = '[data-template]';\n\n  /**\n   * ------------------------------------------------------------------------\n   * Class Definition\n   * ------------------------------------------------------------------------\n   */\n\n  class Page {\n    /**\n     * Creates an instance of Page.\n     * @param {string} pageName\n     */\n    constructor(pageName) {\n      this.name = pageName;\n      this.events = [];\n      this.templatePath = null;\n      this.renderFunction = null;\n      this.route = `/${pageName}`;\n      this.routeRegex = null;\n      this.routeParams = [];\n\n      this.setRoute(`/${pageName}`);\n    }\n\n    // getters\n\n    static get version() {\n      return `${NAME}.${VERSION}`;\n    }\n\n    /**\n     * Get events\n     * @returns {Function[]}\n     */\n    getEvents() {\n      return this.events;\n    }\n\n    /**\n     * Get template\n     * @returns {string}\n     */\n    getTemplate() {\n      return this.template;\n    }\n\n    /**\n     * Get route\n     * @returns {string}\n     */\n    getRoute() {\n      return {\n        route: this.route,\n        regex: this.routeRegex,\n        params: this.routeParams,\n      };\n    }\n\n    /**\n     * Set route\n     * @returns {undefined}\n     */\n    setRoute(route) {\n      const regParams = /{(.*?)}/g;\n\n      this.route = route;\n      this.routeRegex = `${route.replace(/({.*?})/g, '(.*?)')}$`;\n      this.routeParams = (route.match(regParams) || []).map(e => e.replace(regParams, '$1'));\n    }\n\n    getRouteLink(params = null) {\n      const reg = /{(.*?)}/g;\n      const { route } = this.getRoute();\n      const linkWithParams = (route.match(reg) || []).reduce((cur, param) => {\n        const paramName = param.replace(/{|}/g, '');\n        return cur.replace(new RegExp(param), params ? params[paramName] : 'null');\n      }, route);\n\n      return linkWithParams;\n    }\n\n    validHash(hash) {\n      const link = this.getRouteLink(this.getParams(hash));\n      return link === hash;\n    }\n\n    getParams(hash) {\n      const hashParams = {};\n      const { regex, params } = this.getRoute();\n      const hashValues = (new RegExp(regex, 'g').exec(hash) || []).slice(1);\n\n      params.forEach((p, i) => {\n        hashParams[p] = hashValues[i];\n      });\n\n      return hashParams;\n    }\n\n    /**\n     * Get render function\n     * @returns {Function}\n     */\n    getRenderFunction() {\n      return this.renderFunction;\n    }\n\n    async renderTemplate() {\n      const pageElement = document.querySelector(`[data-page=\"${this.name}\"]`);\n\n      let render = async function (DOMPage, template, elements) {\n        if (elements) {\n          Array.from(elements).forEach((el) => {\n            el.innerHTML = template;\n          });\n        } else {\n          DOMPage.innerHTML = template;\n        }\n      };\n\n      if (this.getRenderFunction()) {\n        render = this.getRenderFunction();\n      }\n\n      await render(pageElement, this.getTemplate(), Array.from(pageElement.querySelectorAll(TEMPLATE_SELECTOR) || []));\n    }\n\n    // public\n\n    /**\n     *\n     * @param {*} callbackFn\n     */\n    addEvents(callbackFn) {\n      this.events.push(callbackFn);\n    }\n\n    /**\n     * Use the given template\n     *\n     * @param {string} template\n     * @param {Function} renderFunction\n     */\n    setTemplate(template = null, renderFunction = null) {\n      if (typeof template !== 'string') {\n        throw new Error(`The template path must be a string. ${typeof template} is given`);\n      }\n\n      this.template = template;\n\n      if (typeof renderFunction === 'function') {\n        this.renderFunction = renderFunction;\n      }\n    }\n\n    /**\n     * Add a transition handler\n     *\n     * @param {Function} fn\n     */\n    preventTransition(fn) {\n      if (typeof fn !== 'function') {\n        throw new Error(`${NAME}: invalid function to handle page transitions`);\n      }\n      this.preventTransitionFn = fn;\n    }\n\n    getPreventTransition() {\n      return this.preventTransitionFn;\n    }\n\n    /**\n     * Trigger scopes\n     * @param {string} eventName\n     * @param {{}} [eventParams={}]\n     */\n    triggerScopes(eventName, eventParams = {}) {\n      const eventNameAlias = `on${eventName.charAt(0).toUpperCase()}${eventName.slice(1)}`;\n\n      this.events.forEach((scope) => {\n        const scopeEvent = scope[eventName];\n        const scopeEventAlias = scope[eventNameAlias];\n        if (typeof scopeEvent === 'function') {\n          scopeEvent.apply(this, [eventParams]);\n        }\n\n        // trigger the event alias\n        if (typeof scopeEventAlias === 'function') {\n          scopeEventAlias.apply(this, [eventParams]);\n        }\n      });\n\n      dispatchPageEvent(eventName, this.name, eventParams);\n    }\n  }\n\n  return Page;\n})();\n\nexport default Page;\n","// @todo keep ?\nif (typeof window !== 'undefined') {\n  window.addEventListener('error', () => {\n    console.error('An error has occured! You can pen an issue here: https://github.com/quark-dev/Phonon-Framework/issues');\n  });\n}\n\n// Use available events\nlet availableEvents = ['mousedown', 'mousemove', 'mouseup'];\nlet touchScreen = false;\n\nif (typeof window !== 'undefined') {\n  if (('ontouchstart' in window) || window.DocumentTouch && document instanceof DocumentTouch) {\n    touchScreen = true;\n    availableEvents = ['touchstart', 'touchmove', 'touchend', 'touchcancel'];\n  }\n\n  if (window.navigator.pointerEnabled) {\n    availableEvents = ['pointerdown', 'pointermove', 'pointerup', 'pointercancel'];\n  } else if (window.navigator.msPointerEnabled) {\n    availableEvents = ['MSPointerDown', 'MSPointerMove', 'MSPointerUp', 'MSPointerCancel'];\n  }\n}\n\nconst el = document.createElement('div');\nconst transitions = [\n  { name: 'transition', start: 'transitionstart', end: 'transitionend' },\n  { name: 'MozTransition', start: 'transitionstart', end: 'transitionend' },\n  { name: 'msTransition', start: 'msTransitionStart', end: 'msTransitionEnd' },\n  { name: 'WebkitTransition', start: 'webkitTransitionStart', end: 'webkitTransitionEnd' },\n];\nconst animations = [\n  { name: 'animation', start: 'animationstart', end: 'animationend' },\n  { name: 'MozAnimation', start: 'animationstart', end: 'animationend' },\n  { name: 'msAnimation', start: 'msAnimationStart', end: 'msAnimationEnd' },\n  { name: 'WebkitAnimation', start: 'webkitAnimationStart', end: 'webkitAnimationEnd' },\n];\n\nconst transitionStart = transitions.find(t => el.style[t.name] !== undefined).start;\nconst transitionEnd = transitions.find(t => el.style[t.name] !== undefined).end;\nconst animationStart = animations.find(t => el.style[t.name] !== undefined).start;\nconst animationEnd = animations.find(t => el.style[t.name] !== undefined).end;\n\nexport default {\n  // touch screen support\n  TOUCH_SCREEN: touchScreen,\n\n  // network\n  NETWORK_ONLINE: 'online',\n  NETWORK_OFFLINE: 'offline',\n  NETWORK_RECONNECTING: 'reconnecting',\n  NETWORK_RECONNECTING_SUCCESS: 'reconnect.success',\n  NETWORK_RECONNECTING_FAILURE: 'reconnect.failure',\n\n  // user interface states\n  SHOW: 'show',\n  SHOWN: 'shown',\n  HIDE: 'hide',\n  HIDDEN: 'hidden',\n\n  // hash\n  HASH: 'hash',\n\n  // touch, mouse and pointer events polyfill\n  START: availableEvents[0],\n  MOVE: availableEvents[1],\n  END: availableEvents[2],\n  CANCEL: typeof availableEvents[3] === 'undefined' ? null : availableEvents[3],\n\n  // click\n  CLICK: 'click',\n\n  // transitions\n  TRANSITION_START: transitionStart,\n  TRANSITION_END: transitionEnd,\n\n  // animations\n  ANIMATION_START: animationStart,\n  ANIMATION_END: animationEnd,\n\n  // selectbox\n  ITEM_SELECTED: 'itemSelected',\n};\n","/**\n * --------------------------------------------------------------------------\n * Licensed under MIT (https://github.com/quark-dev/Phonon-Framework/blob/master/LICENSE)\n * --------------------------------------------------------------------------\n */\n\nimport Page from './page';\nimport Event from '../../common/events';\n\nconst Pager = (() => {\n  /**\n   * ------------------------------------------------------------------------\n   * Constants\n   * ------------------------------------------------------------------------\n   */\n\n  const NAME = 'pager';\n  const VERSION = '2.0.0';\n  const DEFAULT_PROPERTIES = {\n    hashPrefix: '#!',\n    useHash: true,\n    defaultPage: null,\n    animatePages: true,\n  };\n\n  let currentPage;\n  let lastHash = null;\n\n  /**\n   * ------------------------------------------------------------------------\n   * Class Definition\n   * ------------------------------------------------------------------------\n   */\n\n  class Pager {\n    /**\n     * @constructor\n     *\n     * @param options {Object}\n     */\n    constructor(options = {}) {\n      this.options = Object.assign(DEFAULT_PROPERTIES, options);\n\n      this.pages = [];\n      this.started = false;\n\n      // add global listeners such ash hash change, navigation, etc.\n      this.addPagerEvents();\n\n      // faster way to init pages before the DOM is ready\n      this.onDOMLoaded();\n    }\n\n    // private\n    _(selector) {\n      return document.querySelector(selector);\n    }\n\n    getRoute() {\n      return window.location.hash.split(this.options.hashPrefix)[1];\n    }\n\n    getHash() {\n      return window.location.hash;\n    }\n\n    getHashParams() {\n      const page = this.getPageModel(currentPage);\n      return page.getParams(this.getHash());\n    }\n\n    getPageFromHash() {\n      const hash = this.getHash() || '';\n      const page = this.getPages().find(p => hash.match(p.getRoute().regex));\n\n      return page ? page.name : null;\n    }\n\n    setHash(pageName, params = null) {\n      const page = this.getPageModel(pageName);\n      if (!page) {\n        throw new Error(`Cannot change the route of unknown page ${pageName}`);\n      }\n\n      window.location.hash = `${this.options.hashPrefix}${page.getRouteLink(params)}`;\n    }\n\n    isPageOf(pageName1, pageName2) {\n      const page1 = this.getPageModel(pageName1);\n      const page2 = this.getPageModel(pageName2);\n      return page1 && page2 && page1.name === page2.name;\n    }\n\n    /**\n     * Attaches the main events for tracking hash changes,\n     * click on navigation buttons and links and back history\n     */\n    addPagerEvents() {\n      document.addEventListener('click', event => this.onClick(event));\n      document.addEventListener('DOMContentLoaded', event => this.onDOMLoaded(event));\n      if (this.options.useHash) {\n        window.addEventListener('hashchange', event => this.onHashChange(event));\n      }\n    }\n\n    // getters\n\n    static get version() {\n      return `${NAME}.${VERSION}`;\n    }\n\n    async preventChangePage(oldPageName, pageName, params) {\n      const oldPage = this.getPageModel(oldPageName);\n      const preventFn = oldPage.getPreventTransition();\n\n      if (typeof preventFn === 'function') {\n        return preventFn(oldPageName, pageName, params);\n      }\n\n      return false;\n    }\n\n    // public\n\n    async showPage(pageName, params = null, back = false) {\n      /*\n       * If we he use the hash as trigger,\n       * we change it dynamically so that the hashchange event is called\n       * Otherwise, we show the page\n       */\n      if (this.options.useHash && this.getPageFromHash() !== pageName) {\n        this.setHash(pageName, params);\n        return;\n      }\n\n      const oldPage = this._('.current');\n      let oldPageName = null;\n\n      if (oldPage) {\n        oldPageName = oldPage.getAttribute('data-page');\n\n        if (this.isPageOf(pageName, oldPageName)) {\n          return;\n        }\n\n        if (await this.preventChangePage(oldPageName, pageName, params)) {\n          if (this.options.useHash) {\n            window.location.hash = lastHash;\n          }\n\n          return;\n        }\n\n        oldPage.classList.remove('current');\n\n        // history\n        window.history.replaceState({ page: pageName }, oldPageName);\n\n        this.triggerPageEvent(oldPageName, Event.HIDE);\n      }\n\n      currentPage = pageName;\n\n      // new page\n      const newPage = this._(`[data-page=\"${currentPage}\"]`);\n\n      newPage.classList.add('current');\n\n      // render template\n      const pageModel = this.getPageModel(currentPage);\n\n      const hashParams = pageModel.getParams(this.getHash());\n\n      this.triggerPageEvent(currentPage, Event.SHOW, hashParams);\n\n\n      if (pageModel && pageModel.getTemplate()) {\n        await pageModel.renderTemplate();\n      }\n\n      if (oldPage) {\n        // use of prototype-oriented language\n        oldPage.back = back;\n        oldPage.previousPageName = oldPageName;\n\n        const onPageAnimationEnd = () => {\n          if (oldPage.classList.contains('animate')) {\n            oldPage.classList.remove('animate');\n          }\n\n          oldPage.classList.remove(oldPage.back ? 'pop-page' : 'push-page');\n\n          this.triggerPageEvent(currentPage, Event.SHOWN, hashParams);\n          this.triggerPageEvent(oldPage.previousPageName, Event.HIDDEN);\n\n          oldPage.removeEventListener(Event.ANIMATION_END, onPageAnimationEnd);\n        };\n\n        if (this.options.animatePages) {\n          oldPage.addEventListener(Event.ANIMATION_END, onPageAnimationEnd);\n          oldPage.classList.add('animate');\n        } else {\n          onPageAnimationEnd();\n        }\n\n        oldPage.classList.add(back ? 'pop-page' : 'push-page');\n      }\n\n      lastHash = this.getHash();\n    }\n\n    addUniquePageModel(pageName) {\n      if (!this.getPageModel(pageName)) {\n        this.getPages().push(new Page(pageName));\n      }\n    }\n\n    getPageModel(pageName) {\n      return this.getPages().find(page => page.name === pageName);\n    }\n\n    triggerPageEvent(pageName, eventName, eventParams = null) {\n      const pageModel = this.getPageModel(pageName);\n      if (pageModel) {\n        pageModel.triggerScopes(eventName, eventParams);\n      }\n    }\n\n    onClick(event) {\n      const pageName = event.target.getAttribute('data-navigate');\n      const backAnimation = event.target.getAttribute('data-pop-page') === 'true';\n\n      if (!pageName) {\n        return;\n      }\n\n      this.showPage(pageName, null, backAnimation);\n    }\n\n    onHashChange() {\n      const params = this.getHashParams();\n      const navPage = this.getPageFromHash();\n\n      // avoid concurrent pages if prevent page change is defined\n      if (navPage === currentPage) {\n        this.triggerPageEvent(currentPage, Event.HASH, params);\n      }\n\n\n      if (navPage) {\n        this.showPage(navPage, null, false, params);\n      }\n    }\n\n    /**\n     * Queries the page nodes in the DOM\n     */\n    onDOMLoaded() {\n      const pages = document.querySelectorAll('[data-page]');\n\n      if (!pages) {\n        return;\n      }\n\n      pages.forEach((page) => {\n        /*\n         * the page name can be given with the attribute data-page\n         * or with its node name\n         */\n        const pageName = page.getAttribute('data-page') || page.nodeName;\n\n        this.addUniquePageModel(pageName);\n      });\n    }\n\n    getPage(pageName, addPageModel = true) {\n      if (addPageModel) {\n        this.addUniquePageModel(pageName);\n      }\n\n      return this.getPageModel(pageName);\n    }\n\n    getPages() {\n      return this.pages;\n    }\n\n    start(forceDefaultPage = false) {\n      let force = forceDefaultPage;\n\n      // check if the app has been already started\n      if (this.started) {\n        throw new Error(`${NAME}. The app has been already started.`);\n      }\n\n      this.started = true;\n\n      // force default page on Cordova\n      if (window.cordova) {\n        force = true;\n      }\n\n      let pageName = this.getPageFromHash();\n\n      if (!this.getPageModel(pageName)) {\n        pageName = this.options.defaultPage;\n      }\n\n      const page = this.getPageModel(pageName);\n\n      if (force && !this.options.defaultPage) {\n        throw new Error(`${NAME}. The default page must exist for forcing its launch!`);\n      }\n\n      /*\n       * if the app is configurated to use hash tracking\n       * we add the page dynamically in the url\n       */\n      if (this.options.useHash) {\n        if (!page.validHash(this.getRoute())) {\n          this.setHash(pageName);\n        }\n      }\n\n      this.showPage(force ? this.options.defaultPage : pageName);\n    }\n\n    // static\n    static DOMInterface(options) {\n      return new Pager(options);\n    }\n  }\n\n  return Pager;\n})();\n\nexport default Pager;\n","/**\n* --------------------------------------------------------------------------\n* Licensed under MIT (https://github.com/quark-dev/Phonon-Framework/blob/master/LICENSE)\n* --------------------------------------------------------------------------\n*/\n\nconst Binder = (() => {\n  /**\n  * ------------------------------------------------------------------------\n  * Constants\n  * ------------------------------------------------------------------------\n  */\n\n  const NAME = 'i18n-binder';\n  const VERSION = '2.0.0';\n\n  /**\n   * ------------------------------------------------------------------------\n   * Class Definition\n   * ------------------------------------------------------------------------\n   */\n\n  class Binder {\n    /**\n     * @param {HTMLElement} element\n     * @param {Object} data\n     */\n    constructor(element, data) {\n      this.element = element;\n      this.data = data;\n\n      if (!this.isElement(this.element)) {\n        console.log('Warning, an element is invalid');\n        return;\n      }\n\n      // array of HTMLElement\n      if (this.element.length && this.element.length > 0) {\n        this.setNodes(this.element);\n      } else {\n        // single HTMLElement\n        this.setNode(this.element);\n      }\n    }\n\n    // getters\n\n    static get version() {\n      return `${NAME}.${VERSION}`;\n    }\n\n    /**\n     * Checks if the given argument is a DOM element\n     * @param {Element} the argument to test\n     * @returns {boolean} true if the object is a DOM element, false otherwise\n     */\n    isElement(element) {\n      if (element === null) {\n        return false;\n      }\n\n      return element instanceof Node || element instanceof NodeList;\n    }\n\n    /**\n    * Binds some text to the given DOM element\n    * @param {HTMLElement} element\n    * @param {String} text\n    */\n    setText(element, text) {\n      if (!('textContent' in element)) {\n        element.innerText = text;\n      } else {\n        element.textContent = text;\n      }\n    }\n\n    /**\n     * Binds some html to the given DOM element\n     * @param {HTMLElement} element\n     * @param {String} text\n     */\n    setHtml(element, text) {\n      element.innerHTML = text;\n    }\n\n    /**\n     * Binds custom attributes to the given DOM element\n     * @param {HTMLElement} element\n     * @param {String} attr\n     * @param {String} text\n     */\n    setAttribute(element, attr, text) {\n      element.setAttribute(attr, text);\n    }\n\n    /**\n     * Binds DOM elements\n     * @param {HTMLElement} element\n     */\n    setNode(element) {\n      let attr = element.getAttribute('data-t');\n      if (!attr) {\n        return;\n      }\n\n      attr = attr.trim();\n\n      const r = /(?:\\s|^)([A-Za-z-_0-9]+):\\s*(.*?)(?=\\s+\\w+:|$)/g;\n      let m;\n\n      while (m = r.exec(attr)) {\n        const key = m[1].trim();\n        const value = m[2].trim().replace(',', '');\n        let i18nValue = this.data[value];\n\n        if (!this.data[value]) {\n          console.log(`${NAME}. Warning, ${value} does not exist.`);\n          i18nValue = value;\n        }\n\n        const methodName = `set${key.charAt(0).toUpperCase()}${key.slice(1)}`;\n\n        if (this[methodName]) {\n          this[methodName](element, i18nValue);\n        } else {\n          this.setAttribute(element, key, i18nValue);\n        }\n      }\n    }\n\n    /**\n     * Binds DOM elements\n     * @param {HTMLElement} element\n     */\n    setNodes(element) {\n      Array.from(element).forEach(el => this.setNode(el));\n    }\n  }\n\n  return Binder;\n})();\n\nexport default Binder;\n","/**\n * --------------------------------------------------------------------------\n * Licensed under MIT (https://github.com/quark-dev/Phonon-Framework/blob/master/LICENSE)\n * --------------------------------------------------------------------------\n */\nimport Binder from './binder';\n\nconst I18n = (() => {\n  /**\n   * ------------------------------------------------------------------------\n   * Constants\n   * ------------------------------------------------------------------------\n   */\n\n  const NAME = 'i18n';\n  const VERSION = '2.0.0';\n  const DEFAULT_PROPERTIES = {\n    fallbackLocale: 'en-US',\n    locale: 'en-US',\n    bind: false,\n    data: null,\n  };\n\n  /**\n   * ------------------------------------------------------------------------\n   * Class Definition\n   * ------------------------------------------------------------------------\n   */\n\n  class I18n {\n    /**\n     * Creates an instance of I18n.\n     * @param {fallbackLocale: string, locale: string, bind: boolean, data: {[lang: string]: {[key: string]: string}}}\n     */\n    constructor(options = {}) {\n      this.options = Object.assign(DEFAULT_PROPERTIES, options);\n\n      if (typeof this.options.fallbackLocale !== 'string') {\n        throw new Error(`${NAME}. The fallback locale is mandatory and must be a string.`);\n      }\n\n      if (this.options.data === null) {\n        throw new Error(`${NAME}. There is no translation data.`);\n      }\n\n      if (typeof this.options.data[this.options.fallbackLocale] !== 'object') {\n        throw new Error(`${NAME}. The fallback locale must necessarily have translation data.`);\n      }\n\n      this.setLocale(this.options.locale, this.options.bind);\n    }\n\n    static get version() {\n      return `${NAME}.${VERSION}`;\n    }\n\n    getLocale() {\n      return this.options.locale;\n    }\n\n    getFallbackLocale() {\n      return this.options.fallbackLocale;\n    }\n\n    /**\n     * Set default locale\n     * @param {string} locale\n     * @param {boolean} [bind=true]\n     */\n    setLocale(locale, bind = false) {\n      if (typeof this.options.data[locale] !== 'object') {\n        console.error(`${NAME}. ${locale} has no data, fallback in ${this.options.fallbackLocale}.`);\n      } else {\n        this.options.locale = locale;\n      }\n\n      if (bind) {\n        this.updateHtml();\n      }\n    }\n\n    getLanguages() {\n      return Object.keys(this.options.data);\n    }\n\n    insertValues(value = null, injectableValues = {}) {\n      if (typeof value !== 'string') {\n        return undefined;\n      }\n\n      const match = value.match(/:([a-zA-Z-_0-9]+)/);\n      if (match) {\n        value = value.replace(match[0], injectableValues[match[1]]);\n      }\n\n      if (value.match(/:([a-zA-Z-_0-9]+)/)) {\n        return this.insertValues(value, injectableValues);\n      }\n\n      return value;\n    }\n\n    translate(keyName = null, inject = {}) {\n      let data = this.options.data[this.options.locale];\n      if (!data) {\n        data = this.options.data[this.options.fallbackLocale];\n      }\n\n      if (keyName === null || keyName === '*' || Array.isArray(keyName)) {\n        if (Array.isArray(keyName)) {\n          const keys = Object.keys(data).filter(key => keyName.indexOf(key) > -1);\n          const filteredData = {};\n          keys.forEach((key) => {\n            filteredData[key] = this.insertValues(data[key], inject);\n          });\n          data = filteredData;\n        }\n\n        const dataMap = {};\n        for (const key in data) {\n          dataMap[key] = this.insertValues(data[key], inject);\n        }\n\n        return dataMap;\n      }\n\n      return this.insertValues(data[keyName], inject);\n    }\n\n    // alias of t()\n    t(keyName = null, inject = {}) {\n      return this.translate(keyName, inject);\n    }\n\n    /**\n     * Updates the HTML views\n     * @param {HTMLElement} element\n     */\n    updateHtml(element = null) {\n      let el = element;\n\n      if (!el) {\n        el = document.querySelectorAll('[data-t]');\n      }\n\n      if (typeof el === 'string') {\n        el = document.querySelector(el);\n      }\n\n      /* eslint no-new: 0 */\n      new Binder(el, this.t());\n    }\n\n    // static\n    static DOMInterface(options) {\n      return new I18n(options);\n    }\n  }\n\n  return I18n;\n})();\n\nexport default I18n;\n","/**\n * --------------------------------------------------------------------------\n * Licensed under MIT (https://github.com/quark-dev/Phonon-Framework/blob/master/LICENSE)\n * --------------------------------------------------------------------------\n */\n\n// single-page modules\nimport Pager from './hybrid-apps/pager';\nimport I18n from './hybrid-apps/i18n';\n\nconst api = {};\n\n/**\n * ------------------------------------------------------------------------\n * Pager\n * ------------------------------------------------------------------------\n */\napi.pager = (options) => {\n  /* eslint no-underscore-dangle: 0 */\n  if (typeof api._pager === 'undefined') {\n    api._pager = Pager.DOMInterface(options);\n  }\n  return api._pager;\n};\n\n/**\n * ------------------------------------------------------------------------\n * i18n\n * ------------------------------------------------------------------------\n */\napi.i18n = I18n.DOMInterface;\n\nif (window.phonon) {\n  window.phonon.pager = api.pager;\n  window.phonon.i18n = api.i18n;\n} else {\n  window.phonon = api;\n}\n\nexport default api;\n"],"names":["dispatchPageEvent","eventName","pageName","detail","fullEventName","window","dispatchEvent","CustomEvent","document","Page","NAME","VERSION","TEMPLATE_SELECTOR","name","events","templatePath","renderFunction","route","routeRegex","routeParams","setRoute","template","regex","params","regParams","replace","match","map","e","reg","getRoute","linkWithParams","reduce","cur","param","paramName","RegExp","hash","link","getRouteLink","getParams","hashParams","hashValues","exec","slice","forEach","p","i","pageElement","querySelector","render","DOMPage","elements","Array","from","el","innerHTML","getRenderFunction","getTemplate","querySelectorAll","callbackFn","push","Error","fn","preventTransitionFn","eventParams","eventNameAlias","charAt","toUpperCase","scope","scopeEvent","scopeEventAlias","apply","addEventListener","console","error","availableEvents","touchScreen","DocumentTouch","navigator","pointerEnabled","msPointerEnabled","createElement","transitions","start","end","animations","transitionStart","find","t","style","undefined","transitionEnd","animationStart","animationEnd","TOUCH_SCREEN","NETWORK_ONLINE","NETWORK_OFFLINE","NETWORK_RECONNECTING","NETWORK_RECONNECTING_SUCCESS","NETWORK_RECONNECTING_FAILURE","SHOW","SHOWN","HIDE","HIDDEN","HASH","START","MOVE","END","CANCEL","CLICK","TRANSITION_START","TRANSITION_END","ANIMATION_START","ANIMATION_END","ITEM_SELECTED","Pager","DEFAULT_PROPERTIES","hashPrefix","useHash","defaultPage","animatePages","currentPage","lastHash","options","Object","assign","pages","started","addPagerEvents","onDOMLoaded","selector","location","split","page","getPageModel","getHash","getPages","pageName1","pageName2","page1","page2","event","onClick","onHashChange","oldPageName","oldPage","preventFn","getPreventTransition","back","getPageFromHash","setHash","_","getAttribute","isPageOf","preventChangePage","classList","remove","history","replaceState","triggerPageEvent","Event","newPage","add","pageModel","renderTemplate","previousPageName","onPageAnimationEnd","contains","removeEventListener","triggerScopes","target","backAnimation","showPage","getHashParams","navPage","nodeName","addUniquePageModel","addPageModel","forceDefaultPage","force","cordova","validHash","Binder","element","data","isElement","log","length","setNodes","setNode","Node","NodeList","text","innerText","textContent","attr","setAttribute","trim","r","m","key","value","i18nValue","methodName","I18n","fallbackLocale","locale","bind","setLocale","updateHtml","keys","injectableValues","insertValues","keyName","inject","isArray","filter","indexOf","filteredData","dataMap","translate","api","pager","_pager","DOMInterface","i18n","phonon"],"mappings":"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"}